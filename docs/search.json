[
  {
    "objectID": "da-21.html",
    "href": "da-21.html",
    "title": "Daily Assignment 21",
    "section": "",
    "text": "library(dataRetrieval)\n\nWarning: package 'dataRetrieval' was built under R version 4.4.3\n\nlibrary(tidymodels)\n\n── Attaching packages ────────────────────────────────────── tidymodels 1.2.0 ──\n\n\n✔ broom        1.0.7     ✔ recipes      1.1.1\n✔ dials        1.3.0     ✔ rsample      1.2.1\n✔ dplyr        1.1.4     ✔ tibble       3.2.1\n✔ ggplot2      3.5.1     ✔ tidyr        1.3.1\n✔ infer        1.0.7     ✔ tune         1.2.1\n✔ modeldata    1.4.0     ✔ workflows    1.1.4\n✔ parsnip      1.2.1     ✔ workflowsets 1.1.0\n✔ purrr        1.0.2     ✔ yardstick    1.3.1\n\n\nWarning: package 'recipes' was built under R version 4.4.3\n\n\n── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──\n✖ purrr::discard() masks scales::discard()\n✖ dplyr::filter()  masks stats::filter()\n✖ dplyr::lag()     masks stats::lag()\n✖ recipes::step()  masks stats::step()\n• Learn how to get started at https://www.tidymodels.org/start/\n\nlibrary(dplyr)\nlibrary(tsibble)\n\nWarning: package 'tsibble' was built under R version 4.4.3\n\n\nRegistered S3 method overwritten by 'tsibble':\n  method               from \n  as_tibble.grouped_df dplyr\n\n\n\nAttaching package: 'tsibble'\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, union\n\n\n\npoudre_flow &lt;- readNWISdv(siteNumber = \"06752260\",  \n                          parameterCd = \"00060\",    \n                          startDate = \"2013-01-01\",   \n                          endDate = \"2023-12-31\") %&gt;% \n  renameNWISColumns() %&gt;%                             \n  mutate(Date = yearmonth(Date)) %&gt;%                  \n  group_by(Date)%&gt;%\n  \n  #1: Converting to tsibble\n  summarise(Flow = mean(Flow, na.rm = TRUE)) %&gt;% \n  as_tsibble(index = Date)\n\nGET:https://waterservices.usgs.gov/nwis/dv/?site=06752260&format=waterml%2C1.1&ParameterCd=00060&StatCd=00003&startDT=2013-01-01&endDT=2023-12-31\n\n\n\n#2: Plotting time series data\n\nlibrary(ggplot2)\n\nggplot(poudre_flow, aes(x = Date, y = Flow)) +\n  geom_line(color = \"steelblue\") +\n  labs(title = \"Monthly Mean Flow at Site 06752260\",\n       x = \"Date\",\n       y = \"Flow (cfs)\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n# Animate with plotly \n\nlibrary(plotly)\n\nWarning: package 'plotly' was built under R version 4.4.3\n\n\n\nAttaching package: 'plotly'\n\n\nThe following object is masked from 'package:ggplot2':\n\n    last_plot\n\n\nThe following object is masked from 'package:stats':\n\n    filter\n\n\nThe following object is masked from 'package:graphics':\n\n    layout\n\nggplot_obj &lt;- ggplot(poudre_flow, aes(x = Date, y = Flow)) +\n  geom_line(color = \"steelblue\") +\n  labs(title = \"Monthly Mean Flow at Site 06752260\",\n       x = \"Date\",\n       y = \"Flow (cfs)\") +\n  theme_minimal()\n\nggplotly(ggplot_obj)\n\n\n\n\n\n\n#3: Subseries \nlibrary(feasts)\n\nWarning: package 'feasts' was built under R version 4.4.3\n\n\nLoading required package: fabletools\n\n\nWarning: package 'fabletools' was built under R version 4.4.3\n\n\n\nAttaching package: 'fabletools'\n\n\nThe following object is masked from 'package:yardstick':\n\n    accuracy\n\n\nThe following object is masked from 'package:parsnip':\n\n    null_model\n\n\nThe following objects are masked from 'package:infer':\n\n    generate, hypothesize\n\nlibrary(fabletools)\nlibrary(ggplot2)\n\ngg_season(poudre_flow, Flow) +\n  labs(title = \"Seasonal Plot of Streamflow\",\n       y = \"Flow (cfs)\") +\n  theme_minimal()\n\n\n\n\n\n\n\n# In this plot, seasons are defined by the calendar months, assuming monthly seasonablity. Subseries are time series broken down by season, in this case, one for each month. The data shows a sharp increase in streamflow from April to July, likely because of increased temperatures resulting in more snowmelt and runoff. Rainfall is also typically higher during these months. In 2014, there is outlying data from August to October with a sharp increase in streamflow. \n\n\n#4: Decompose \n\npoudre_flow_stl &lt;- poudre_flow %&gt;%\n  model(stl = STL(Flow ~ trend(window = 13) + season(window = \"periodic\")))\n\ncomponents(poudre_flow_stl) %&gt;%\n  autoplot() +\n  labs(title = \"STL Decomposition of Monthly Streamflow\")\n\n\n\n\n\n\n\n# The data is showing strong seasonal peak each year during the spring and early summer likely because of snow melt and resulting runoff. There are lows in the late summer and winter. This shows a seasonal pattern, repeating every 12 months. This also shows long-term changes in streamflow. The streamflow remains fairly consistent with slight decreases in streamflow over the years. This slight change could be a result of humans consuming water resources faster than they can be replaced, reducing overall streamflow."
  }
]